"--------------------------------
" ZeroKnight's VIMRC ~ Functions
" Last changed: 31/05/2012
"--------------------------------

" Smart HOME
function! SmartHome()
    let s:col = col(".")
    normal! ^
    if s:col == col(".")
        normal! 0
    endif
endfunction
nnoremap <silent> <Home> :call SmartHome()<CR>
inoremap <silent> <Home> <C-O>:call SmartHome()<CR>
nnoremap <silent> 0 :call SmartHome()<CR>


" Session Save/Load shortcut
command! -nargs=1 Ss :mksession! ~/.vim/sessions/<args>.vim
command! -nargs=1 Sl :source ~/.vim/sessions/<args>.vim


" Checks for existence of var, returns val if found
function! VarExists(var, val)
    if exists(a:var) | return a:val | else | return '' | endif
endfunction

" Reloads snipMate without having to restart Vim
function! ReloadSnipMate(snippets_dir, ft)
    call ResetSnippets()
    call GetSnippets(a:snippets_dir, a:ft)
endfunction
map <silent> ,sr :call ReloadSnipMate(snippets_dir, &ft)<CR>:echo "Snippets reloaded"<CR>

" Converts DOS EOL to UNIX
function! DosToUnixEOL()
    update             " Save any changes
    e ++ff=dos         " Edit file again, using dos format ('fileformats' ignored)
    setlocal ff=unix   " Buffer will use LF-only line endings when written
    write              " Write the buffer (using LF-only line endings)
endfunction
map <silent> ,eol :call DosToUnixEOL()<CR>
