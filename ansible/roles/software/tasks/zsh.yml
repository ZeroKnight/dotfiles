# vim: ft=yaml.ansible

- name: Install zsh (Suse)
  become: true
  community.general.zypper:
    name:
      - zsh
    state: latest
  when: ansible_os_family == 'Suse'

- name: Install zsh (Debian)
  become: true
  ansible.builtin.apt:
    name:
      - zsh
      - zsh-doc
    state: latest
  when: ansible_os_family == 'Debian'

- name: Ensure zsh directories
  ansible.builtin.file:
    path: "{{ item }}"
    state: directory
    mode: "0755"
  loop:
    - "{{ (opt_dir, 'zcomet') | path_join }}"
    - "{{ (data_dir, 'zsh', 'site') | path_join }}"

- name: Clone zcomet
  ansible.builtin.git:
    repo: https://github.com/agkozak/zcomet
    dest: "{{ (opt_dir, 'zcomet', 'bin') | path_join }}"
    depth: 1
